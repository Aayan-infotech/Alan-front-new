import{r as n,j as t}from"./index-DL5taDVF.js";import{a as l}from"./index-DW_MHI2K.js";import{F as p,f as V,a as q,b as G,c as J,d as K}from"./index-DWFs_9Jd.js";/* empty css                             */import{C as Q,a as W}from"./CCardBody-D1K57JHO.js";import{C as X}from"./CCardHeader-YPvH19q6.js";import{a as I}from"./index.esm-BZN3EXKz.js";import{C as Y,a as Z,b as A,c as d,d as ee,e as i,f as te,g as ae,h as se,i as re,j as oe}from"./CTable-DPqkE7aM.js";import{C as ne}from"./CForm-HRzsMEuT.js";import{a as x,C as N}from"./CFormInput-Bmg2GR8s.js";import{C as M}from"./CFormSelect-BxuutBKw.js";import"./DefaultLayout-Bp0ODGA1.js";import"./cil-user-Ddrdy7PS.js";const be=()=>{const[u,h]=n.useState([]),[C,B]=n.useState([]),[j,F]=n.useState([]),[f,b]=n.useState(""),[S,y]=n.useState(""),[_,v]=n.useState(""),[w,E]=n.useState(null),[H,g]=n.useState(!1),[c,T]=n.useState(null),k=async()=>{try{const{data:e}=await l.get("http://18.221.196.222:7878/api/categories");B(e.map(a=>({id:a._id,name:a.name})))}catch(e){console.error("Error fetching categories:",e)}},$=e=>{l.get(`http://18.221.196.222:7878/api/subcategory?category_id=${e}`).then(a=>{F(a.data.map(s=>({id:s._id,name:s.name})))}).catch(a=>{console.error("Error fetching subcategories:",a)})};n.useEffect(()=>{D()},[]);const D=async()=>{l.get("http://18.221.196.222:7878/api/subSubCategories").then(e=>{h(e.data)}).catch(e=>{console.error("Error fetching sub-sub-categories:",e)})},U=()=>{const e=C.find(o=>o.name===f),a=j.find(o=>o.name===S);if(!e||!a){alert("Please select valid category and sub-category");return}const s=new FormData;s.append("images",w),s.append("category_id",e.id),s.append("sub_category_id",a.id),s.append("name",_),s.append("status",1),s.append("ins_date",new Date().toISOString()),s.append("ins_ip","127.0.0.1"),l.post("http://18.221.196.222:7878/api/subSubCategories",s,{headers:{"Content-Type":"multipart/form-data"}}).then(o=>{D(),g(!1),m()}).catch(o=>{console.error("Error adding sub-sub-category:",o)})},L=e=>{T(e),b(e.category),y(e.subCategory),v(e.name),E(e.images),g(!0),k()},P=()=>{var s,o;const e={images:w,category_id:(s=C.find(r=>r.name===f))==null?void 0:s.id,sub_category_id:(o=j.find(r=>r.name===S))==null?void 0:o.id,name:_,status:c.status,ins_date:c.ins_date,ins_ip:"127.0.0.1",ins_by:null},a=c._id;a?l.put(`http://18.221.196.222:7878/api/subSubCategories/${a}`,e).then(()=>{h(u.map(r=>r._id===a?{...r,...e}:r)),g(!1),m()}).catch(r=>{console.error("Error updating sub-sub-category:",r)}):console.error("Invalid ID for update:",c)},R=e=>{const a=e._id;a?l.delete(`http://18.221.196.222:7878/api/subSubCategories/${a}`).then(()=>{h(u.filter(s=>s._id!==a))}).catch(s=>{console.error("Error deleting sub-sub-category:",s)}):console.error("Invalid ID for deletion:",e)},z=e=>{const s=u.find(r=>r._id===e).status===1?0:1,o={status:s};l.put(`http://18.221.196.222:7878/api/subSubCategories/${e}`,o).then(()=>{h(u.map(r=>r._id===e?{...r,status:s}:r))}).catch(r=>{console.error("Error toggling status:",r)})},O=e=>{const a=e.target.files[0];a&&E(a)},m=()=>{b(""),y(""),v(""),E(null),T(null),F([])};return t.jsxs(t.Fragment,{children:[t.jsxs(Q,{children:[t.jsx(X,{children:t.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[t.jsx("h5",{children:"Sub-Sub-Category Management"}),t.jsxs(I,{color:"primary",onClick:()=>{g(!0),k(),m()},children:[t.jsx(p,{icon:V})," Add Sub-Sub-Category"]})]})}),t.jsx(W,{children:t.jsxs(Y,{striped:!0,bordered:!0,hover:!0,responsive:!0,className:"subcategory-table",children:[t.jsx(Z,{children:t.jsxs(A,{children:[t.jsx(d,{children:"Index"}),t.jsx(d,{children:"Category"}),t.jsx(d,{children:"Sub-Category"}),t.jsx(d,{children:"Sub-Sub-Category"}),t.jsx(d,{children:"Image"}),t.jsx(d,{children:"Status"}),t.jsx(d,{children:"Actions"})]})}),t.jsx(ee,{children:u.length===0?t.jsx(A,{children:t.jsx(i,{colSpan:7,style:{textAlign:"center"},children:"No Sub-Sub-Categories Available"})}):u.map((e,a)=>t.jsxs(A,{children:[t.jsx(i,{children:a+1}),t.jsx(i,{children:e.category_name}),t.jsx(i,{children:e.sub_category_name}),t.jsx(i,{children:e.name}),t.jsx(i,{children:e.images?t.jsx("img",{src:e.images,alt:e.name,width:"50",height:"50"}):"No Image"}),t.jsx(i,{children:e.status===1?"Active":"Inactive"}),t.jsxs(i,{children:[t.jsx(p,{icon:e.status===1?q:G,onClick:()=>z(e._id),style:{cursor:"pointer",margin:"0 8px",color:e.status===1?"green":"red"}}),t.jsx(p,{icon:J,color:"warning",onClick:()=>L(e),style:{margin:"0 8px",cursor:"pointer"}}),t.jsx(p,{icon:K,color:"danger",onClick:()=>R(e),style:{cursor:"pointer"}})]})]},a))})]})})]}),t.jsxs(te,{size:"md",visible:H,onClose:()=>g(!1),children:[t.jsx(ae,{children:t.jsx(se,{children:c?"Edit Sub-Sub-Category":"Add Sub-Sub-Category"})}),t.jsx(re,{children:t.jsxs(ne,{children:[t.jsx(x,{children:"Category"}),t.jsxs(M,{value:f,onChange:e=>{b(e.target.value),$(e.target.value)},children:[t.jsx("option",{value:"",children:"Select Category"}),C.map(e=>t.jsx("option",{value:e.name,children:e.name},e.id))]}),t.jsx(x,{children:"Sub-Category"}),t.jsxs(M,{value:S,onChange:e=>y(e.target.value),children:[t.jsx("option",{value:"",children:"Select Sub-Category"}),j.map(e=>t.jsx("option",{value:e.name,children:e.name},e.id))]}),t.jsx(x,{children:"Sub-Sub-Category Name"}),t.jsx(N,{type:"text",value:_,onChange:e=>v(e.target.value)}),t.jsx(x,{children:"Image"}),t.jsx(N,{type:"file",onChange:O})]})}),t.jsxs(oe,{children:[t.jsx(I,{color:"secondary",onClick:()=>{g(!1),m()},children:"Cancel"}),t.jsx(I,{color:"primary",onClick:c?P:U,children:c?"Update":"Add"})]})]})]})};export{be as default};
