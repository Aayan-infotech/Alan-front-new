import{r as s,j as a}from"./index-DL5taDVF.js";import{a as r}from"./index-DW_MHI2K.js";import{F as u,f as D,a as M,b as B,c as H,d as U}from"./index-DWFs_9Jd.js";/* empty css                             */import{C as $,a as q}from"./CCardBody-D1K57JHO.js";import{C as L}from"./CCardHeader-YPvH19q6.js";import{a as y}from"./index.esm-BZN3EXKz.js";import{C as O,a as R,b as j,c,d as P,e as o,f as V,g as z,h as G,i as J,j as K}from"./CTable-DPqkE7aM.js";import{C as Q}from"./CForm-HRzsMEuT.js";import{a as f,C as N}from"./CFormInput-Bmg2GR8s.js";import{C as W}from"./CFormSelect-BxuutBKw.js";import"./DefaultLayout-Bp0ODGA1.js";import"./cil-user-Ddrdy7PS.js";const de=()=>{const[b,i]=s.useState([]),[d,p]=s.useState(""),[g,h]=s.useState(""),[m,x]=s.useState(null),[F,n]=s.useState(!1),[l,S]=s.useState(null),[w,_]=s.useState([]);s.useEffect(()=>{(async()=>{try{const t=await r.get("http://18.221.196.222:7878/api/categories");_(t.data)}catch(t){console.error("Error fetching categories:",t)}})()},[]),s.useEffect(()=>{(async()=>{try{const t=await r.get("http://18.221.196.222:7878/api/subcategory");i(t.data)}catch(t){console.error("Error fetching sub-categories:",t)}})()},[]);const v=async()=>{if(d&&g&&m){const e=new FormData;e.append("name",d),e.append("category_id",g),e.append("images",m),e.append("status","1"),e.append("ins_date",new Date().toISOString()),e.append("ins_ip","127.0.0.1");try{await r.post("http://18.221.196.222:7878/api/subcategory",e,{headers:{"Content-Type":"multipart/form-data"}}),p(""),h(""),x(null),n(!1);const t=await r.get("http://18.221.196.222:7878/api/subcategory");i(t.data)}catch(t){console.error("Error adding sub-category:",t)}}},E=async()=>{if(l){const e=new FormData;e.append("name",d),e.append("category_id",g),m instanceof File&&e.append("images",m),e.append("status","1"),e.append("ins_date",new Date().toISOString()),e.append("ins_ip","127.0.0.1");try{await r.put(`http://18.221.196.222:7878/api/subcategory/${l._id}`,e,{headers:{"Content-Type":"multipart/form-data"}}),p(""),h(""),x(null),n(!1),S(null);const t=await r.get("http://18.221.196.222:7878/api/subcategory");i(t.data)}catch(t){console.error("Error updating sub-category:",t)}}},I=async e=>{try{await r.delete(`http://18.221.196.222:7878/api/subcategory/${e._id}`);const t=await r.get("http://18.221.196.222:7878/api/subcategory");i(t.data)}catch(t){console.error("Error deleting sub-category:",t)}},T=async e=>{try{const t={...e,status:e.status===1?0:1};await r.put(`http://18.221.196.222:7878/api/subcategory/${e._id}`,t);const C=await r.get("http://18.221.196.222:7878/api/subcategory");i(C.data)}catch(t){console.error("Error toggling status:",t)}},k=e=>{const t=e.target.files[0];t&&x(t)},A=e=>{const t=w.find(C=>C._id===e);return t?t.name:"N/A"};return a.jsxs(a.Fragment,{children:[a.jsxs($,{className:"subcategory-card",children:[a.jsx(L,{className:"subcategory-card-header",children:a.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[a.jsx("h5",{children:"Sub-Category Management"}),a.jsxs(y,{color:"primary",onClick:()=>n(!0),className:"add-subcategory-btn",children:[a.jsx(u,{icon:D})," Add Sub-Category"]})]})}),a.jsx(q,{className:"subcategory-card-body",children:a.jsxs(O,{striped:!0,bordered:!0,hover:!0,responsive:!0,className:"subcategory-table",children:[a.jsx(R,{children:a.jsxs(j,{children:[a.jsx(c,{children:"Index"}),a.jsx(c,{children:"Image"}),a.jsx(c,{children:"Sub-Category Name"}),a.jsx(c,{children:"Category"}),a.jsx(c,{children:"Status"}),a.jsx(c,{children:"Actions"})]})}),a.jsx(P,{children:b.length===0?a.jsx(j,{children:a.jsx(o,{colSpan:6,className:"text-center",children:"No Sub-Categories Available"})}):b.map((e,t)=>a.jsxs(j,{children:[a.jsx(o,{children:t+1}),a.jsx(o,{children:e.images&&e.images.length>0?a.jsx("img",{src:e.images[0],alt:"Sub-category",style:{width:"50px",height:"50px",objectFit:"cover"}}):a.jsx("span",{children:"No Image"})}),a.jsx(o,{children:e.name}),a.jsx(o,{children:A(e.category_id)}),a.jsx(o,{children:e.status===1?"Active":"Blocked"}),a.jsxs(o,{children:[a.jsx(u,{icon:e.status===1?M:B,onClick:()=>T(e),style:{cursor:"pointer",margin:"0 8px",color:e.status===1?"green":"red"}}),a.jsx(u,{icon:H,onClick:()=>{n(!0),S(e),p(e.name),h(e.category_id)},style:{cursor:"pointer",margin:"0 8px"}}),a.jsx(u,{icon:U,onClick:()=>I(e),style:{cursor:"pointer",margin:"0 8px",color:"red"}})]})]},e._id))})]})})]}),a.jsxs(V,{visible:F,onClose:()=>n(!1),children:[a.jsx(z,{children:a.jsxs(G,{children:[l?"Edit":"Add"," Sub-Category"]})}),a.jsx(J,{children:a.jsxs(Q,{children:[a.jsx(f,{htmlFor:"subCategoryName",children:"Sub-Category Name"}),a.jsx(N,{id:"subCategoryName",type:"text",value:d,onChange:e=>p(e.target.value),required:!0}),a.jsx(f,{htmlFor:"category",children:"Category"}),a.jsxs(W,{id:"category",value:g,onChange:e=>h(e.target.value),required:!0,children:[a.jsx("option",{value:"",children:"Select Category"}),w.map(e=>a.jsx("option",{value:e._id,children:e.name},e._id))]}),a.jsx(f,{htmlFor:"image",children:"Image"}),a.jsx(N,{id:"image",type:"file",onChange:k,accept:"image/*"})]})}),a.jsxs(K,{children:[a.jsx(y,{color:"secondary",onClick:()=>n(!1),children:"Close"}),a.jsxs(y,{color:"primary",onClick:l?E:v,children:[l?"Update":"Add"," Sub-Category"]})]})]})]})};export{de as default};
