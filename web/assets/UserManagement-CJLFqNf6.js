import{r as l,j as e}from"./index-DL5taDVF.js";import{a as i}from"./index-DW_MHI2K.js";import{a,c as b}from"./index.esm-BZN3EXKz.js";import{C as $,a as F}from"./CCardBody-D1K57JHO.js";import{C as P}from"./CCardHeader-YPvH19q6.js";import{C as z,a as R,b as w,c as n,d as Z,e as o,f as E,g as k,h as A,i as I,j as N}from"./CTable-DPqkE7aM.js";import{c as q}from"./cil-lock-locked-DmxpJbVL.js";import{c as G}from"./cil-pencil-m516yCOw.js";import{c as J}from"./cil-trash-CBbKHhHb.js";import{C as K}from"./CForm-HRzsMEuT.js";import{a as j,C as p}from"./CFormInput-Bmg2GR8s.js";import"./DefaultLayout-Bp0ODGA1.js";import"./cil-user-Ddrdy7PS.js";var O=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M384,200V144A128,128,0,0,0,166.418,52.57l22.4,22.855A96,96,0,0,1,352,144v56H88V328c0,92.636,75.364,168,168,168s168-75.364,168-168V200Zm8,128c0,74.99-61.009,136-136,136s-136-61.01-136-136V232H392Z' class='ci-primary'/>"];const d="http://18.221.196.222:7878/api/AdminUsers",ce=()=>{const[M,S]=l.useState([]),[T,t]=l.useState(!1),[C,y]=l.useState(!1),[r,u]=l.useState({id:"",name:"",email:"",mobile:"",password:"",status:"Active"}),[g,m]=l.useState(null),[_,U]=l.useState(!0),h=async()=>{try{U(!0);const s=await i.get(d);S(s.data.data)}catch(s){console.error("Error fetching users:",s)}finally{U(!1)}};l.useEffect(()=>{h()},[]);const x=s=>{const{name:f,value:c}=s.target;u({...r,[f]:c})},v=()=>{u({id:"",name:"",email:"",mobile:"",password:"",status:""}),y(!1),t(!0),console.log("handleAddUser",v())},D=s=>{u({...s,id:s._id}),y(!0),t(!0)},L=async()=>{try{return(await i.get("https://api.ipify.org?format=json")).data.ip}catch(s){return console.error("Error fetching IP address:",s),""}},B=async()=>{try{const s=await L();C?await i.put(`${d}/${r.id}`,{name:r.name,email:r.email,mobile:r.mobile,ins_ip:s}):await i.post(d,{name:r.name,email:r.email,mobile:r.mobile,password:r.password,ins_ip:s}),h(),t(!1)}catch(s){console.error("Error saving user:",s)}},H=async()=>{try{await i.delete(`${d}/${g}`),h(),m(null)}catch(s){console.error("Error deleting user:",s)}},V=async(s,f)=>{try{const c=f===1?0:1;await i.put(`${d}/${s}`,{status:c}),h()}catch(c){console.error("Error updating status:",c)}};return e.jsxs("div",{className:"container mt-4",children:[e.jsxs($,{children:[e.jsxs(P,{children:[e.jsx("h3",{children:"User Management"}),e.jsx(a,{color:"primary",onClick:v,children:"Add User"})]}),e.jsx(F,{children:_?e.jsx("p",{children:"Loading..."}):e.jsxs(z,{hover:!0,responsive:!0,children:[e.jsx(R,{color:"dark",children:e.jsxs(w,{children:[e.jsx(n,{children:"ID"}),e.jsx(n,{children:"Name"}),e.jsx(n,{children:"Email"}),e.jsx(n,{children:"mobile"}),e.jsx(n,{children:"status"}),e.jsx(n,{children:"Actions"})]})}),e.jsx(Z,{children:M.map(s=>e.jsxs(w,{children:[e.jsx(o,{children:s._id}),e.jsx(o,{children:s.name}),e.jsx(o,{children:s.email}),e.jsx(o,{children:s.mobile||"N/A"}),e.jsx(o,{children:e.jsx(o,{children:e.jsxs(a,{color:s.status===1?"success":"secondary",size:"sm",onClick:()=>V(s._id,s.status),children:[e.jsx(b,{icon:s.status===1?O:q,className:"me-1"}),s.status===1?"Enabled":"Disabled"]})})}),e.jsxs(o,{children:[e.jsx(a,{color:"info",size:"sm",onClick:()=>D(s),className:"me-2",children:e.jsx(b,{icon:G})}),e.jsx(a,{color:"danger",size:"sm",onClick:()=>m(s._id),children:e.jsx(b,{icon:J})})]})]},s._id))})]})})]}),e.jsxs(E,{visible:T,onClose:()=>t(!1),children:[e.jsx(k,{closeButton:!0,children:e.jsx(A,{children:C?"Edit User":"Add User"})}),e.jsx(I,{children:e.jsxs(K,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(j,{children:"Name"}),e.jsx(p,{type:"text",name:"name",value:r.name,onChange:x})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(j,{children:"Email"}),e.jsx(p,{type:"email",name:"email",value:r.email,onChange:x})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(j,{children:"mobile"}),e.jsx(p,{type:"text",name:"mobile",value:r.mobile,onChange:x})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(j,{children:"Create Password"}),e.jsx(p,{type:"password",name:"password",value:r.password,onChange:x,placeholder:"Create a password"})]})]})}),e.jsxs(N,{children:[e.jsx(a,{color:"secondary",onClick:()=>t(!1),children:"Cancel"}),e.jsx(a,{color:"primary",onClick:B,children:C?"Update":"Add"})]})]}),e.jsxs(E,{visible:g!==null,onClose:()=>m(null),children:[e.jsx(k,{closeButton:!0,children:e.jsx(A,{children:"Confirm Delete"})}),e.jsx(I,{children:"Are you sure you want to delete this user?"}),e.jsxs(N,{children:[e.jsx(a,{color:"secondary",onClick:()=>m(null),children:"Cancel"}),e.jsx(a,{color:"danger",onClick:H,children:"Delete"})]})]})]})};export{ce as default};
