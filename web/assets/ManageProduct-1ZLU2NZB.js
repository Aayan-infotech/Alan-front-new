import{r as o,_ as ee,R as ae,b as F,c as se,P as i,d as pe,k as je,j as e,C as fe}from"./index-DL5taDVF.js";import{a as h}from"./index-DW_MHI2K.js";import{F as w,c as _e,d as q,e as Se,g as ve}from"./index-DWFs_9Jd.js";import{C as z,a as C}from"./CRow-Bj4MggOl.js";import{C as Ne,a as Ie}from"./CCardBody-D1K57JHO.js";import{C as Fe}from"./CCardHeader-YPvH19q6.js";import{C as G}from"./CForm-HRzsMEuT.js";import{a as l,C as S}from"./CFormInput-Bmg2GR8s.js";import{C as v}from"./CFormSelect-BxuutBKw.js";import{C as Ee,a as N}from"./index.esm-BZN3EXKz.js";import{C as Pe,a as Ae}from"./CInputGroupText-DsJBkNLA.js";import{C as we,a as ke,b as J,c as I,d as De,e as b,f as K,g as Q,h as V,i as X,j as Z}from"./CTable-DPqkE7aM.js";import"./DefaultLayout-Bp0ODGA1.js";import"./cil-user-Ddrdy7PS.js";var $=o.forwardRef(function(n,E){var c,P=n.children,g=n.as,d=g===void 0?"ul":g,r=n.className,y=n.flush,u=n.layout,p=ee(n,["children","as","className","flush","layout"]);return ae.createElement(d,F({className:se("list-group",(c={"list-group-flush":y},c["list-group-".concat(u)]=u,c),r)},p,{ref:E}),P)});$.propTypes={as:i.elementType,children:i.node,className:i.string,flush:i.bool,layout:i.oneOf(["horizontal","horizontal-sm","horizontal-md","horizontal-lg","horizontal-xl","horizontal-xxl"])};$.displayName="CListGroup";var H=o.forwardRef(function(n,E){var c,P=n.children,g=n.active,d=n.as,r=d===void 0?"li":d,y=n.className,u=n.disabled,p=n.color,j=ee(n,["children","active","as","className","disabled","color"]),k=r==="a"||r==="button"?Ee:r;return j=F(F(F(F({},(r==="a"||r==="button")&&{active:g,disabled:u,as:r,ref:E}),g&&{"aria-current":!0}),u&&{"aria-disabled":!0}),j),ae.createElement(k,F({className:se("list-group-item",(c={},c["list-group-item-".concat(p)]=p,c["list-group-item-action"]=r==="a"||r==="button",c.active=g,c.disabled=u,c),y)},j),P)});H.propTypes={active:i.bool,as:i.elementType,children:i.node,className:i.string,color:pe,disabled:i.bool};H.displayName="CListGroupItem";const Qe=()=>{var U,Y,W;const n=je(),E=(a,s)=>{s==="Windows"?n("/DimensionsProduct",{state:{Product_id:a}}):s==="Doors"&&n("/DimensionsProductDoors",{state:{productIdfordet:a}})},[c,P]=o.useState(null),[g,d]=o.useState(!1),[r,y]=o.useState({_id:"",name:"",category_name:"",sub_category_name:"",sub_sub_category_name:"",status:""}),[u,p]=o.useState([]),[j,k]=o.useState([]),[O,M]=o.useState([]),[t,D]=o.useState({category:"",subCategory:"",subSubCategory:"",status:"",search:""}),[te,R]=o.useState([]),[f,L]=o.useState([]),[re,T]=o.useState(!1),[Te,Me]=o.useState(null),[oe,B]=o.useState(!1);o.useEffect(()=>{h.get("http://18.221.196.222:7878/api/categories").then(a=>p(a.data)).catch(a=>console.error("Error fetching categories:",a))},[]),o.useEffect(()=>{t.category?h.get(`http://18.221.196.222:7878/api/subcategory/categoryid/${t.category}`).then(a=>{k(a.data.data||(Array.isArray(a.data)?a.data:[]))}).catch(a=>console.error("Error fetching subcategories:",a)):k([]),D(a=>({...a,subCategory:"",subSubCategory:""})),M([])},[t.category]),o.useEffect(()=>{t.subCategory?h.get(`http://18.221.196.222:7878/api/subSubCategories/subcategoryid/${t.subCategory}`).then(a=>{M(a.data.data||(Array.isArray(a.data)?a.data:[]))}).catch(a=>console.error("Error fetching subsubcategories:",a)):M([]),D(a=>({...a,subSubCategory:""}))},[t.subCategory]),o.useEffect(()=>{B(!0),h.get("http://18.221.196.222:7878/api/products").then(a=>{R(a.data),B(!1)}).catch(a=>{console.error("Error fetching products:",a),B(!1)})},[]);const A=a=>{const{name:s,value:m}=a.target;D(x=>({...x,[s]:m}))},ne=t.category?(U=u.find(a=>a._id===t.category))==null?void 0:U.name:"",ce=t.subCategory?(Y=j.find(a=>a._id===t.subCategory))==null?void 0:Y.name:"",le=t.subSubCategory?(W=O.find(a=>a._id===t.subSubCategory))==null?void 0:W.name:"",ie=te.filter(a=>{const s=t.category?a.category_name===ne:!0,m=t.subCategory?a.sub_category_name===ce:!0,x=t.subSubCategory?a.sub_sub_category_name===le:!0,Ce=t.status?a.status===t.status:!0,ye=t.search?a.name.toLowerCase().includes(t.search.toLowerCase()):!0;return s&&m&&x&&Ce&&ye}),de=a=>{const s=a.target.files;s&&L([...f,...s])},ue=a=>{y({_id:a._id||"",name:a.name||"",category_name:a.category_name||"",sub_category_name:a.sub_category_name||"",sub_sub_category_name:a.sub_sub_category_name||"",productFormulaAdded:a.productFormulaAdded||"",status:a.status||""}),d(!0)},_=a=>{const{name:s,value:m}=a.target;y(x=>({...x,[s]:m}))},me=()=>{h.put(`http://18.221.196.222:7878/api/products/${r._id}`,r).then(()=>{alert("Product updated successfully"),d(!1),h.get("http://18.221.196.222:7878/api/products").then(a=>R(a.data)).catch(a=>console.error("Error refetching products:",a))}).catch(a=>console.error("Error updating product:",a))},he=a=>{h.delete(`http://18.221.196.222:7878/api/products/DEL/${a}`).then(()=>{alert("Product deleted successfully"),R(s=>s.filter(m=>m._id!==a))}).catch(s=>console.error("Error deleting product:",s))},ge=a=>{P(a),T(!0),xe(a)},be=()=>{if(f.length>0&&c){const a=new FormData;a.append("Product_id",c),f.forEach(s=>a.append("images",s)),h.post("http://18.221.196.222:7878/api/ProductImg/product-images",a).then(()=>{alert("Images uploaded successfully"),T(!1),L([])}).catch(s=>console.error("Error uploading images:",s))}},xe=a=>{h.get(`http://18.221.196.222:7878/api/ProductImg/product-images/${a}`).then(s=>{if(s.data.productImages){const m=s.data.productImages.flatMap(x=>x.images);L(m)}else console.error("No product images found")}).catch(s=>console.error("Error fetching images:",s))};return e.jsxs(z,{children:[e.jsx(C,{xs:"12",md:"8",lg:"12",children:e.jsxs(Ne,{children:[e.jsx(Fe,{children:e.jsx("h4",{children:"Manage Products"})}),e.jsxs(Ie,{children:[e.jsx(G,{className:"mb-4",children:e.jsxs(z,{children:[e.jsxs(C,{xs:"12",md:"3",children:[e.jsx(l,{htmlFor:"category",children:"Category"}),e.jsxs(v,{id:"category",name:"category",value:t.category,onChange:A,children:[e.jsx("option",{value:"",children:"Select Category"}),u.map(a=>e.jsx("option",{value:a._id,children:a.name},a._id))]})]}),e.jsxs(C,{xs:"12",md:"3",children:[e.jsx(l,{htmlFor:"subCategory",children:"Subcategory"}),e.jsxs(v,{id:"subCategory",name:"subCategory",value:t.subCategory,onChange:A,children:[e.jsx("option",{value:"",children:"Select Subcategory"}),t.category&&j.map(a=>e.jsx("option",{value:a._id,children:a.name},a._id))]})]}),e.jsxs(C,{xs:"12",md:"3",children:[e.jsx(l,{htmlFor:"subSubCategory",children:"Sub-subcategory"}),e.jsxs(v,{id:"subSubCategory",name:"subSubCategory",value:t.subSubCategory,onChange:A,children:[e.jsx("option",{value:"",children:"Select Sub-subcategory"}),t.subCategory&&O.map(a=>e.jsx("option",{value:a._id,children:a.name},a._id))]})]}),e.jsxs(C,{xs:"12",md:"2",children:[e.jsx(l,{htmlFor:"status",children:"Status"}),e.jsxs(v,{id:"status",name:"status",value:t.status,onChange:A,children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Blocked",children:"Blocked"})]})]}),e.jsx(C,{xs:"12",md:"1",className:"d-flex align-items-end",children:e.jsx(N,{color:"primary",onClick:()=>D({category:"",subCategory:"",subSubCategory:"",status:"",search:""}),children:"Reset"})}),e.jsx(C,{xs:"12",md:"12",children:e.jsxs(Pe,{className:"mt-3",children:[e.jsx(Ae,{children:"Search"}),e.jsx(S,{name:"search",value:t.search,onChange:A,placeholder:"Search Product"})]})})]})}),oe?e.jsx(z,{className:"justify-content-center",children:e.jsx(fe,{color:"primary"})}):e.jsxs(we,{striped:!0,children:[e.jsx(ke,{children:e.jsxs(J,{children:[e.jsx(I,{children:"Product Name"}),e.jsx(I,{children:"Category"}),e.jsx(I,{children:"Subcategory"}),e.jsx(I,{children:"Sub-subcategory"}),e.jsx(I,{children:"Status"}),e.jsx(I,{children:"Actions"})]})}),e.jsx(De,{children:ie.map(a=>e.jsxs(J,{children:[e.jsx(b,{children:a.name}),e.jsx(b,{children:a.category_name}),e.jsx(b,{children:a.sub_category_name}),e.jsx(b,{children:a.sub_sub_category_name}),e.jsx(b,{children:a.status}),e.jsxs(b,{children:[e.jsxs(b,{children:[e.jsx("span",{className:"icon-clickable",onClick:()=>ue(a),style:{cursor:"pointer",color:"orange",marginRight:"8px"},title:"Edit",children:e.jsx(w,{icon:_e})}),e.jsx(w,{icon:q,color:"red",onClick:()=>he(a._id),style:{cursor:"pointer",marginRight:"8px"},title:"Delete"}),e.jsx(w,{icon:Se,color:"blue",onClick:()=>ge(a._id),style:{cursor:"pointer",marginRight:"8px"},title:"Add Images"})]}),e.jsx(b,{children:e.jsx(w,{icon:ve,color:"blue",onClick:()=>E(a._id,a.category_name),style:{cursor:"pointer"},title:"Add Dimensions"})})]})]},a._id))})]})]})]})}),e.jsxs(K,{visible:re,onClose:()=>T(!1),children:[e.jsx(Q,{children:e.jsx(V,{children:"Manage Images"})}),e.jsx(X,{children:e.jsxs(G,{children:[e.jsx(l,{htmlFor:"productImages",children:"Upload Images"}),e.jsx(S,{type:"file",id:"productImages",multiple:!0,onChange:de}),e.jsx($,{className:"mt-3",children:f&&f.length>0?f.map((a,s)=>e.jsxs(H,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("img",{src:a,alt:`Product Image ${s}`,width:"50",height:"50"}),e.jsx(N,{color:"danger",size:"sm",onClick:()=>deleteImage(c,a),children:e.jsx(w,{icon:q})})]},s)):e.jsx("p",{children:"No images found for this product."})})]})}),e.jsxs(Z,{children:[e.jsx(N,{color:"secondary",onClick:()=>T(!1),children:"Close"}),e.jsx(N,{color:"primary",onClick:be,children:"Add Images"})]})]}),e.jsxs(K,{visible:g,onClose:()=>d(!1),children:[e.jsx(Q,{children:e.jsx(V,{children:"Edit Product"})}),e.jsx(X,{children:e.jsxs(G,{children:[e.jsx(l,{htmlFor:"name",children:"Product Name"}),e.jsx(S,{id:"name",name:"name",value:r.name,onChange:_}),e.jsx(l,{htmlFor:"category_name",children:"Category"}),e.jsx(S,{id:"category_name",name:"category_name",value:r.category_name||"",onChange:_}),e.jsx(l,{htmlFor:"sub_category_name",children:"Subcategory"}),e.jsx(S,{id:"sub_category_name",name:"sub_category_name",value:r.sub_category_name||"",onChange:_}),e.jsx(l,{htmlFor:"sub_sub_category_name",children:"Sub-subcategory"}),e.jsx(S,{id:"sub_sub_category_name",name:"sub_sub_category_name",value:r.sub_sub_category_name||"",onChange:_}),e.jsx(l,{htmlFor:"productFormulaAdded",children:"Product Formula Added"}),e.jsxs(v,{id:"productFormulaAdded",name:"productFormulaAdded",value:r.productFormulaAdded,onChange:_,children:[e.jsx("option",{value:"Yes",children:"Yes"}),e.jsx("option",{value:"No",children:"No"})]}),e.jsx(l,{htmlFor:"status",children:"Status"}),e.jsxs(v,{id:"status",name:"status",value:r.status,onChange:_,children:[e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Blocked",children:"Blocked"})]})]})}),e.jsxs(Z,{children:[e.jsx(N,{color:"secondary",onClick:()=>d(!1),children:"Close"}),e.jsx(N,{color:"primary",onClick:me,children:"Save Changes"})]})]})]})};export{Qe as default};
