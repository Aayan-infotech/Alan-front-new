import{r as o,j as e}from"./index-DL5taDVF.js";import{a as n}from"./index-DW_MHI2K.js";import{F as h,f as A,a as T,b as M,c as B,d as D}from"./index-DWFs_9Jd.js";/* empty css                             */import{C as U,a as H}from"./CCardBody-D1K57JHO.js";import{C as L}from"./CCardHeader-YPvH19q6.js";import{a as y}from"./index.esm-BZN3EXKz.js";import{C as R,a as P,b as f,c as m,d as $,e as i,f as z,g as O,h as V,i as q,j as G}from"./CTable-DPqkE7aM.js";import{C as J}from"./CForm-HRzsMEuT.js";import{a as N,C as E}from"./CFormInput-Bmg2GR8s.js";import"./DefaultLayout-Bp0ODGA1.js";import"./cil-user-Ddrdy7PS.js";const ne=()=>{const[r,c]=o.useState([]),[C,x]=o.useState(""),[t,u]=o.useState(null),[v,j]=o.useState(!1),[l,w]=o.useState(null);o.useEffect(()=>{(async()=>{try{const s=await n.get("http://18.221.196.222:7878/api/categories");c(s.data)}catch(s){console.error("Error fetching categories:",s)}})()},[]);const b=async()=>{try{return(await n.get("https://api.ipify.org?format=json")).data.ip}catch(a){return console.error("Error fetching IP address:",a),""}},I=async()=>{try{const a=await b(),s=new FormData;s.append("name",C),t&&s.append("images",t),s.append("ins_ip",a),s.append("status",1);const d=await n.post("http://18.221.196.222:7878/api/categories",s);c([...r,d.data.newCategory]),g()}catch(a){console.error("Error adding category:",a)}},_=async()=>{try{const a=await b(),s=new FormData;s.append("name",C),t&&s.append("images",t),s.append("update_ip",a);const d=await n.put(`http://18.221.196.222:7878/api/categories/${l._id}`,s);c(r.map(p=>p._id===l._id?d.data.updatedCategory:p)),g()}catch(a){console.error("Error updating category:",a)}},g=()=>{w(null),x(""),u(null),j(!1)},F=a=>{w(a),x(a.name),u(null),j(!0)},S=async a=>{try{await n.delete(`http://18.221.196.222:7878/api/categories/${a._id}`),c(r.filter(s=>s._id!==a._id))}catch(s){console.error("Error deleting category:",s)}},k=async a=>{try{const s=a.status===1?0:1,d=await n.put(`http://18.221.196.222:7878/api/categories/${a._id}`,{status:s});c(r.map(p=>p._id===a._id?d.data.updatedCategory:p))}catch(s){console.error("Error toggling category status:",s)}};return e.jsxs(e.Fragment,{children:[e.jsxs(U,{className:"categories-card",children:[e.jsx(L,{className:"categories-card-header",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h5",{children:"Categories Management"}),e.jsxs(y,{color:"primary",onClick:()=>j(!0),className:"add-category-btn",children:[e.jsx(h,{icon:A})," Add Category"]})]})}),e.jsx(H,{className:"categories-card-body",children:e.jsxs(R,{striped:!0,bordered:!0,hover:!0,responsive:!0,className:"categories-table",children:[e.jsx(P,{children:e.jsxs(f,{children:[e.jsx(m,{children:"Index"}),e.jsx(m,{children:"Image"}),e.jsx(m,{children:"Name"}),e.jsx(m,{children:"Status"}),e.jsx(m,{children:"Actions"})]})}),e.jsx($,{children:r.length===0?e.jsx(f,{children:e.jsx(i,{colSpan:5,className:"text-center",children:"No Categories Available"})}):r.map((a,s)=>e.jsxs(f,{children:[e.jsx(i,{children:s+1}),e.jsx(i,{children:a.images&&a.images.length>0?e.jsx("img",{src:a.images[0],alt:a.name,style:{width:"50px",height:"50px"}}):"No Image"}),e.jsx(i,{children:a.name}),e.jsx(i,{children:a.status===1?"Active":"Blocked"}),e.jsxs(i,{children:[e.jsx(h,{icon:a.status===1?T:M,onClick:()=>k(a),style:{cursor:"pointer",margin:"0 8px",color:a.status===1?"green":"red"}}),e.jsx(h,{icon:B,color:"warning",onClick:()=>F(a),style:{margin:"0 8px",cursor:"pointer"}}),e.jsx(h,{icon:D,color:"danger",onClick:()=>S(a),style:{cursor:"pointer"}})]})]},s))})]})})]}),e.jsxs(z,{size:"lg",visible:v,onClose:g,children:[e.jsx(O,{children:e.jsx(V,{children:l?"Edit Category":"Add Category"})}),e.jsx(q,{children:e.jsxs(J,{children:[e.jsx(N,{children:"Category Name"}),e.jsx(E,{type:"text",value:C,onChange:a=>x(a.target.value),placeholder:"Enter category name",className:"category-input"}),e.jsx(N,{children:"Category Image"}),e.jsx(E,{type:"file",onChange:a=>u(a.target.files[0])}),t&&e.jsx("div",{className:"image-preview",children:e.jsx("img",{src:URL.createObjectURL(t),alt:"Preview",style:{width:"100px",height:"100px"}})})]})}),e.jsxs(G,{children:[e.jsx(y,{color:"secondary",onClick:g,children:"Cancel"}),e.jsx(y,{color:"primary",onClick:l?_:I,children:l?"Save Changes":"Add Category"})]})]})]})};export{ne as default};
